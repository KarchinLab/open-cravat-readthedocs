

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Case-Control Analysis &mdash; open-cravat  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Cloud" href="Cloud.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> open-cravat
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Home.html">Intro to OpenCRAVAT</a></li>
<li class="toctree-l1"><a class="reference internal" href="API.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cloud.html">Cloud</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Case-Control Analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#installing">Installing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#running">Running</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#gui">GUI</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#interpreting-results">Interpreting results</a></li>
<li class="toctree-l2"><a class="reference internal" href="#p-value-calculation-for-inheritance-modes">P-value calculation for inheritance modes</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">open-cravat</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Case-Control Analysis</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/Case-Control.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="case-control-analysis">
<h1>Case-Control Analysis<a class="headerlink" href="#case-control-analysis" title="Permalink to this headline">¶</a></h1>
<p>OpenCRAVAT can perform basic comparisons between case and control
cohorts in a study. The Case/Control feature allows users to (1) count
samples in case and control groups with particular genotypes, (2)
compute the one-sided p-value using Fisher’s Exact Test. Case and
control sets are defined by a separate input file.</p>
<div class="section" id="installing">
<h2>Installing<a class="headerlink" href="#installing" title="Permalink to this headline">¶</a></h2>
<p>Install the <code class="docutils literal notranslate"><span class="pre">casecontrol</span></code> module. This module may not be available in
older versions of OpenCRAVAT.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>oc module install casecontrol
</pre></div>
</div>
<p>Case/Control requires scipy to perform statistical tests. On most
systems, this can be installed with <code class="docutils literal notranslate"><span class="pre">pip3</span> <span class="pre">install</span> <span class="pre">scipy</span></code>, but consult
the <a class="reference external" href="https://www.scipy.org/install.html">scipy website</a> for more
specific instructions.</p>
</div>
<div class="section" id="running">
<h2>Running<a class="headerlink" href="#running" title="Permalink to this headline">¶</a></h2>
<p>Case-Control may be run from the command line in most OpenCRAVAT
versions, and from the GUI in versions above 2.2.0.</p>
<p>Both methods will require a text file which assigns samples to a cohort.
The file contains two columns, with whitespace as the delimiter.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sample_0</span>    <span class="n">case</span>
<span class="n">sample_1</span>    <span class="n">control</span>
</pre></div>
</div>
<p>Samples which are not in the cohorts file, or are assigned a cohort
other than case or control, will not be included in the analysis.</p>
<p>You will be notified if samples in the cohorts file cannot be found in
the job. In some cases, this is because multiple input files were used.
In that situation, the sample ID must be prefixed with the filename of
the input it came from, and a double underscore. For example, a sample
called <code class="docutils literal notranslate"><span class="pre">sample_0</span></code> from file <code class="docutils literal notranslate"><span class="pre">input.vcf</span></code> would become
<code class="docutils literal notranslate"><span class="pre">input.vcf__sample_0</span></code>. ### Command line</p>
<p>Run casecontrol in the command line by pointing the module to the
cohorts file.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>oc run input --module-option casecontrol.cohorts<span class="o">=</span>cohorts.txt
</pre></div>
</div>
<div class="section" id="gui">
<h3>GUI<a class="headerlink" href="#gui" title="Permalink to this headline">¶</a></h3>
<p>Run casecontrol in the GUI by scrolling to the bottom of the left hand
panel in the submit page, to the section called “Additional Analysis”.
Then, click the “Case-Control cohorts” button to select your cohorts
file.</p>
</div>
</div>
<div class="section" id="interpreting-results">
<h2>Interpreting results<a class="headerlink" href="#interpreting-results" title="Permalink to this headline">¶</a></h2>
<p>There will be nine output columns. The three columns shown by default
are p-values of the likelihood that a variant occurs more in case
samples under three different inheritance models. Six hidden columns
include counts of homozygous, heterozygous and reference variants across
the cohorts.</p>
</div>
<div class="section" id="p-value-calculation-for-inheritance-modes">
<h2>P-value calculation for inheritance modes<a class="headerlink" href="#p-value-calculation-for-inheritance-modes" title="Permalink to this headline">¶</a></h2>
<p>For the Dominant model, we create a 2x2 contingency table to assign a
p-value using a Fisher’s exact test. The first column includes the
number of samples that have any alternate allele, whether heterozygous
or homozygous.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 27%" />
<col style="width: 43%" />
<col style="width: 30%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>Alt (Aa and aa)</p></th>
<th class="head"><p>Ref (A/A)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Cases</p></td>
<td><p>N11</p></td>
<td><p>N12</p></td>
</tr>
<tr class="row-odd"><td><p>Controls</p></td>
<td><p>N21</p></td>
<td><p>N22</p></td>
</tr>
</tbody>
</table>
<p>For the Recessive model, we create a 2x2 contingency table to assign a
p-value using a Fisher’s exact test. The first column includes the
number of samples that are homozygous for the alternate allele.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 28%" />
<col style="width: 28%" />
<col style="width: 44%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>Alt (aa)</p></th>
<th class="head"><p>Ref (AA and aa)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Cases</p></td>
<td><p>N11</p></td>
<td><p>N12</p></td>
</tr>
<tr class="row-odd"><td><p>Controls</p></td>
<td><p>N21</p></td>
<td><p>N22</p></td>
</tr>
</tbody>
</table>
<p>For the allelic model, we create a 2x2 contingency table to assign a
p-value using a Fisher’s exact test. The first column includes the count
of non-reference genotypes and the second column includes the count of
reference genotypes.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 40%" />
<col style="width: 40%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>Alternate genotypes</p></th>
<th class="head"><p>Reference genotypes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Cases</p></td>
<td><p>N11</p></td>
<td><p>N12</p></td>
</tr>
<tr class="row-odd"><td><p>Controls</p></td>
<td><p>N21</p></td>
<td><p>N22</p></td>
</tr>
</tbody>
</table>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="Cloud.html" class="btn btn-neutral float-left" title="Cloud" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Rick Kim, Kyle Moad, Kym Pagel, Madison Larsen, Michael Ryan, Rachel Karchin

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>