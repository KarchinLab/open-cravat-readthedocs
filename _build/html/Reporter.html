

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Reporter tutorial &mdash; open-cravat  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Publish" href="Publish-an-Annotator.html" />
    <link rel="prev" title="Widget tutorial" href="Widget-Tutorial.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> open-cravat
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Home.html">Intro to OpenCRAVAT</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart-command-line.html">Command line quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="1.-Installation-Instructions.html">Installation Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="2.-Command-line-usage.html">Command line usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.-Viewing-Results.html">Viewing results</a></li>
<li class="toctree-l1"><a class="reference internal" href="5.-GUI-usage.html">GUI usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="Uninstallation.html">Uninstallation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Update-Instructions.html">Update instructions</a></li>
</ul>
<p class="caption"><span class="caption-text">Advanced</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Filter-Tutorial.html">Filter tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="Case-Control.html">Case-Control Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cloud.html">Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="API.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="Multiuser-support.html">Multiuser support</a></li>
<li class="toctree-l1"><a class="reference internal" href="OpenCRAVAT-Variant-Report.html">Variant Report</a></li>
<li class="toctree-l1"><a class="reference internal" href="Release-Notes.html">Release notes</a></li>
</ul>
<p class="caption"><span class="caption-text">For contributors</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="File-Formats.html">File Formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="Annotator-Reference.html">Annotator reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="Annotator-Tutorial.html">Annotator tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widget-Tutorial.html">Widget tutorial</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Reporter tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#example">Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#levels">Levels</a></li>
<li class="toctree-l3"><a class="reference internal" href="#structure-of-a-reporter">Structure of a reporter</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#low-level">Low level</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#in-practice">In practice</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Publish-an-Annotator.html">Publish</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">open-cravat</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Reporter tutorial</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/Reporter.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="reporter-tutorial">
<h1>Reporter tutorial<a class="headerlink" href="#reporter-tutorial" title="Permalink to this headline">¶</a></h1>
<p>Reporters are used to generate output files from an OpenCRAVAT output
database.</p>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>Readers who prefer to learn by reading code should see the example
reporter in
<a class="reference external" href="https://github.com/KarchinLab/open-cravat-modules-karchinlab/blob/master/reporters/examplereporter/examplereporter.py">open-cravat-modules-karchinlab</a>.</p>
<p>The rest of this document will explain how reporters are structured, and
the meaning of some low-level data.</p>
</div>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<div class="section" id="levels">
<h3>Levels<a class="headerlink" href="#levels" title="Permalink to this headline">¶</a></h3>
<p>OpenCRAVAT data is structured into 4 levels: variant, gene, sample, and
mapping. These levels correspond directly to four tables in the output
database. The first two levels, variant and gene, contain information
about variants and genes that OpenCRAVAT generates, and data from
annotators. The sample level keeps track of which samples contain a
certain variant, and can include information about specific ocurrences
of a variant, such as zygosity. Finally, the mapping level keeps track
of where in the original input files a variant was found.</p>
<p>Most reporters will be concerned with the variant and gene level data,
and that will be the focus of this page. Sample and mapping level data
can be handled in a similar way.</p>
</div>
<div class="section" id="structure-of-a-reporter">
<h3>Structure of a reporter<a class="headerlink" href="#structure-of-a-reporter" title="Permalink to this headline">¶</a></h3>
<p>Reporters must define four functions: <code class="docutils literal notranslate"><span class="pre">setup</span></code>, <code class="docutils literal notranslate"><span class="pre">write_header</span></code>,
<code class="docutils literal notranslate"><span class="pre">write_table_row</span></code>, and <code class="docutils literal notranslate"><span class="pre">end</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">setup</span></code> is called once. It is used to open file handlers and do other
such initialization tasks.</p>
<p><code class="docutils literal notranslate"><span class="pre">write_header</span></code> is called once per level. It is used to write
information about the data that will be in that level.</p>
<p><code class="docutils literal notranslate"><span class="pre">write_table_row</span></code> is called once per “row” of data. In the variant
level this means once per variant. In the gene level, once per gene.</p>
<p><code class="docutils literal notranslate"><span class="pre">end</span></code> is used to close file handlers and do other such cleanup tasks.</p>
<p>Most of the work of a reporter is done in <code class="docutils literal notranslate"><span class="pre">write_header</span></code> and
<code class="docutils literal notranslate"><span class="pre">write_table_row</span></code>. The following two sections will cover the data
structures of those two functions.</p>
</div>
</div>
<div class="section" id="low-level">
<h2>Low level<a class="headerlink" href="#low-level" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">write_table_row</span></code> takes a single argument, <code class="docutils literal notranslate"><span class="pre">row</span></code>, which is a list of
the values for that row. For example, at the variant level, the first
part of row might be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;chr3&#39;</span><span class="p">,</span> <span class="mi">41266113</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;ULK4&#39;</span><span class="p">,</span> <span class="s1">&#39;ENST00000301831.9&#39;</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</pre></div>
</div>
<p>Each of these columns is identified in a attribute called
<code class="docutils literal notranslate"><span class="pre">self.colinfo</span></code>, a multi-level dict with information about all the
columns in the job. A summary of it’s structure is below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">colinfo</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;variant&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;columns&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s1">&#39;col_name&#39;</span><span class="p">:</span> <span class="s1">&#39;base__uid&#39;</span><span class="p">,</span>
                <span class="s1">&#39;col_title&#39;</span><span class="p">:</span> <span class="s1">&#39;UID&#39;</span><span class="p">,</span>
                <span class="s1">&#39;col_type&#39;</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span><span class="p">,</span>
                <span class="o">...</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="s1">&#39;col_name&#39;</span><span class="p">:</span> <span class="s1">&#39;base__chrom&#39;</span><span class="p">,</span>
                <span class="s1">&#39;col_title&#39;</span><span class="p">:</span> <span class="s1">&#39;Chrom&#39;</span><span class="p">,</span>
                <span class="s1">&#39;col_type&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span>
                <span class="o">...</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="s1">&#39;col_name&#39;</span><span class="p">:</span> <span class="s1">&#39;base__pos&#39;</span><span class="p">,</span>
                <span class="s1">&#39;col_title&#39;</span><span class="p">:</span> <span class="s1">&#39;Position&#39;</span><span class="p">,</span>
                <span class="s1">&#39;col_type&#39;</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span><span class="p">,</span>
                <span class="o">...</span>
            <span class="p">},</span>
            <span class="o">...</span>
        <span class="p">]</span>
        <span class="s1">&#39;colgroups&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;base&#39;</span><span class="p">,</span>
                <span class="s1">&#39;displayname&#39;</span><span class="p">:</span> <span class="s1">&#39;Variant Annotation&#39;</span><span class="p">,</span>
                <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
                <span class="s1">&#39;lastcol&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
                <span class="o">...</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;clinvar&#39;</span><span class="p">,</span>
                <span class="s1">&#39;displayname&#39;</span><span class="p">:</span> <span class="s1">&#39;ClinVar&#39;</span><span class="p">,</span>
                <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                <span class="s1">&#39;lastcol&#39;</span><span class="p">:</span> <span class="mi">21</span><span class="p">,</span>
                <span class="o">...</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">},</span>
    <span class="s1">&#39;gene&#39;</span><span class="p">:{</span><span class="o">...</span><span class="p">},</span>
    <span class="s1">&#39;sample&#39;</span><span class="p">:{</span><span class="o">...</span><span class="p">},</span>
    <span class="s1">&#39;mapping&#39;</span><span class="p">:{</span><span class="o">...</span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>At the top, <code class="docutils literal notranslate"><span class="pre">self.colinfo</span></code> is divided into each level, then into
<code class="docutils literal notranslate"><span class="pre">'columns'</span></code> and <code class="docutils literal notranslate"><span class="pre">'colgroups'</span></code>. The list
<code class="docutils literal notranslate"><span class="pre">self.colinfo['level']['columns']</span></code> matches up with the <code class="docutils literal notranslate"><span class="pre">row</span></code> list
passed to <code class="docutils literal notranslate"><span class="pre">write_table_row</span></code>. Columns from the same annotator are
located next to each other. The list <code class="docutils literal notranslate"><span class="pre">colgroups</span></code> contains information
about each annotator, and can be used to select data from that
annotator.</p>
<div class="section" id="in-practice">
<h3>In practice<a class="headerlink" href="#in-practice" title="Permalink to this headline">¶</a></h3>
<p>Generally, <code class="docutils literal notranslate"><span class="pre">write_header</span></code> reads information from <code class="docutils literal notranslate"><span class="pre">self.colinfo</span></code> and
write descriptions of each column to the output file. Then
<code class="docutils literal notranslate"><span class="pre">write_table_row</span></code> writes the value of each cell.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Publish-an-Annotator.html" class="btn btn-neutral float-right" title="Publish" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Widget-Tutorial.html" class="btn btn-neutral float-left" title="Widget tutorial" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Rick Kim, Kyle Moad, Kym Pagel, Madison Larsen, Michael Ryan, Rachel Karchin

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>